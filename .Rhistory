knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(ggeffects)
library(wesanderson)
potholes <- read.table("casestudy.csv", header=T, sep=",")
head(potholes)
ggplot(potholes[potholes$Scenario=="Current",], aes(Pothole, Prediction, fill=Pothole))+
geom_bar(stat="identity", alpha=0.5)+
scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=15)+
labs(
x="Pothole",
y="Flood Risk Prediction"
) +
theme_pubclean()+
theme(legend.position = "none")
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(Pothole, Prediction, fill=Pothole))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
png("CaseStudy.png", width=600, height = 400)
plt
dev.off()
library(rayshader)
plot_gg(plt)
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(Pothole, Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2), rows = vars(Pothole)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(Pothole, Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2), rows = vars(Pothole)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2), rows = vars(Pothole)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(y=Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2), rows = vars(Pothole)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2),
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, color=Prediction))+
facet_grid(cols = vars(Scenario2),
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, color=Prediction))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
# scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
plot_gg(plt)
plot_gg(plt, width = 5, height = 5, raytrace = FALSE, preview = TRUE)
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, fill=Prediction))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
# scale_fill_brewer(palette = "Dark2")+
# scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
# theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
plot_gg(plt, width = 5, height = 5, raytrace = FALSE, preview = TRUE)
gg = ggplot(diamonds, aes(x, depth)) +
stat_density_2d(aes(fill = stat(nlevel)),
geom = "polygon",
n = 100,bins = 10,contour = TRUE) +
facet_wrap(clarity~.) +
scale_fill_viridis_c(option = "A")
plot_gg(gg,multicore=TRUE,width=5,height=5,scale=250)
plot_gg(plt, width = 5, height = 5, multicore = TRUE, scale = 250,
zoom = 0.7, theta = 10, phi = 30, windowsize = c(800, 800))
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, fill=Potholes))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
# theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
labs <- c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie")
names(labs) <- unique(potholes$Scenario)
potholes$Scenario2 <- rep(c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"), 4)
potholes$Scenario2 <- factor(potholes$Scenario2, levels=c("Current", "Retired", "Low Drainage and Retired", "No Till", "Natural Prairie"))
plt <- ggplot(potholes, aes(x=Pothole, y=Prediction, fill=Pothole))+
facet_grid(cols = vars(Scenario2)
, labeller = labeller(Scenario2 = label_wrap_gen(15))
)+
geom_bar(stat="identity"
, alpha=0.5
)+
scale_fill_brewer(palette = "Dark2")+
scale_fill_hue(l=25)+
labs(
x=NULL,
y="Flood Risk Prediction",
fill=NULL
) +
# theme_pubclean()+
theme(legend.position = "bottom",
axis.text.x=element_blank(), axis.ticks.x = element_blank())
plt
